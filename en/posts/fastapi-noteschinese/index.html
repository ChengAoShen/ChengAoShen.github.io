<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  ⚡️FastAPI Notes(Chinese) · ChengAo Shen
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="ChengAo Shen">
<meta name="description" content="
  引入
  
    
    Link to heading
  


  介绍
  
    
    Link to heading
  

FastAPI 是一个用于构建 API 的现代、快速（高性能）的 web 框架，使用 Python 3.6&#43; 并基于标准的 Python 类型提示。

  安装
  
    
    Link to heading
  

完整安装：pip install &quot;fastapi[all]&quot;，这种安装方式包括了unicorn
部分安装：pip install fastapi

  服务的启动
  
    
    Link to heading
  

一个最简单的FastAPI如下所示：
from fastapi import FastAPI
app = FastAPI()
@app.get(&#34;/&#34;)
async def root():
    return {&#34;message&#34;: &#34;Hello World&#34;}
需要将这个文件所描述的服务进行启动可以使用命令：uvicorn main:app --reload，最后一个reload表示是在更新代码后重新启动

  接口文档
  
    
    Link to heading
  

这个框架会基于openapi自动生成文档，原始的文件在/openai.json中，在/docs和/redoc中可以分别看到两个不同显示界面的文档">
<meta name="keywords" content="ChengAo Shen, homepage,university of houston, personal blog">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="⚡️FastAPI Notes(Chinese)">
  <meta name="twitter:description" content="引入 Link to heading 介绍 Link to heading FastAPI 是一个用于构建 API 的现代、快速（高性能）的 web 框架，使用 Python 3.6&#43; 并基于标准的 Python 类型提示。
安装 Link to heading 完整安装：pip install &#34;fastapi[all]&#34;，这种安装方式包括了unicorn
部分安装：pip install fastapi
服务的启动 Link to heading 一个最简单的FastAPI如下所示：
from fastapi import FastAPI app = FastAPI() @app.get(&#34;/&#34;) async def root(): return {&#34;message&#34;: &#34;Hello World&#34;} 需要将这个文件所描述的服务进行启动可以使用命令：uvicorn main:app --reload，最后一个reload表示是在更新代码后重新启动
接口文档 Link to heading 这个框架会基于openapi自动生成文档，原始的文件在/openai.json中，在/docs和/redoc中可以分别看到两个不同显示界面的文档">

<meta property="og:url" content="https://chengaoshen.com/en/posts/fastapi-noteschinese/">
  <meta property="og:site_name" content="ChengAo Shen">
  <meta property="og:title" content="⚡️FastAPI Notes(Chinese)">
  <meta property="og:description" content="引入 Link to heading 介绍 Link to heading FastAPI 是一个用于构建 API 的现代、快速（高性能）的 web 框架，使用 Python 3.6&#43; 并基于标准的 Python 类型提示。
安装 Link to heading 完整安装：pip install &#34;fastapi[all]&#34;，这种安装方式包括了unicorn
部分安装：pip install fastapi
服务的启动 Link to heading 一个最简单的FastAPI如下所示：
from fastapi import FastAPI app = FastAPI() @app.get(&#34;/&#34;) async def root(): return {&#34;message&#34;: &#34;Hello World&#34;} 需要将这个文件所描述的服务进行启动可以使用命令：uvicorn main:app --reload，最后一个reload表示是在更新代码后重新启动
接口文档 Link to heading 这个框架会基于openapi自动生成文档，原始的文件在/openai.json中，在/docs和/redoc中可以分别看到两个不同显示界面的文档">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="en">
    <meta property="article:published_time" content="2021-03-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-03-21T00:00:00+00:00">




<link rel="canonical" href="https://chengaoshen.com/en/posts/fastapi-noteschinese/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css" integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm&#43;MTzNJdv80k&#43;n0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">

<link rel="icon" type="image/png" href="/images/favicon.png">








</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://chengaoshen.com/">
      ChengAo Shen
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/en/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/en/news/">News</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/en/publications/">Publications</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/en/about/">About Me</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://chengaoshen.com/en/posts/fastapi-noteschinese/">
          ⚡️FastAPI Notes(Chinese)
        </a>
      </h1>
    </header>

    <h2 id="引入">
  引入
  <a class="heading-link" href="#%e5%bc%95%e5%85%a5">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="介绍">
  介绍
  <a class="heading-link" href="#%e4%bb%8b%e7%bb%8d">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>FastAPI 是一个用于构建 API 的现代、快速（高性能）的 web 框架，使用 Python 3.6+ 并基于标准的 Python 类型提示。</p>
<h3 id="安装">
  安装
  <a class="heading-link" href="#%e5%ae%89%e8%a3%85">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>完整安装：<code>pip install &quot;fastapi[all]&quot;</code>，这种安装方式包括了unicorn</p>
<p>部分安装：<code>pip install fastapi</code></p>
<h3 id="服务的启动">
  服务的启动
  <a class="heading-link" href="#%e6%9c%8d%e5%8a%a1%e7%9a%84%e5%90%af%e5%8a%a8">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>一个最简单的FastAPI如下所示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">root</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Hello World&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>需要将这个文件所描述的服务进行启动可以使用命令：<code>uvicorn main:app --reload</code>，最后一个<code>reload</code>表示是在更新代码后重新启动</p>
<h3 id="接口文档">
  接口文档
  <a class="heading-link" href="#%e6%8e%a5%e5%8f%a3%e6%96%87%e6%a1%a3">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>这个框架会基于openapi自动生成文档，原始的文件在<code>/openai.json</code>中，在<code>/docs</code>和<code>/redoc</code>中可以分别看到两个不同显示界面的文档</p>
<h2 id="基础使用">
  基础使用
  <a class="heading-link" href="#%e5%9f%ba%e7%a1%80%e4%bd%bf%e7%94%a8">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="参数">
  参数
  <a class="heading-link" href="#%e5%8f%82%e6%95%b0">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li>
<p>路径参数</p>
<p>在URL的路径中，可以加入部分的参数提供给处理的函数，一个基本的例子如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;item_id&#34;</span><span class="p">:</span> <span class="n">item_id</span><span class="p">}</span>
</span></span></code></pre></div><p>其中<code>{item_id}</code>就是路径参数，在函数的参数列表中被读取并设置了类型<code>int</code>，这一类型设置会自动转换/检测路径中提供的参数是否符合需求，若不符合则会直接进行报错。</p>
<p>在使用路径参数的时候需要注意到其前后顺序，顺序会代表相应的<strong>优先级</strong>，一般固定内容的处理会放在参数内容的处理之前（如下）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 先放置me这一固定的部分</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/users/me&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_user_me</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;user_id&#34;</span><span class="p">:</span> <span class="s2">&#34;the current user&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/users/</span><span class="si">{user_id}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;user_id&#34;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>当我们希望路径参数是一个可选类型的时候，可以使用python中的Enum枚举类型来实现</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ModelName</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span> <span class="c1">#str限制类型为字符串，继承枚举则转变为枚举类型</span>
</span></span><span class="line"><span class="cl">    <span class="n">alexnet</span> <span class="o">=</span> <span class="s2">&#34;alexnet&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">resnet</span> <span class="o">=</span> <span class="s2">&#34;resnet&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lenet</span> <span class="o">=</span> <span class="s2">&#34;lenet&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/models/</span><span class="si">{model_name}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">:</span> <span class="n">ModelName</span><span class="p">):</span> <span class="c1"># 此处的标记将自动将路径参数转换为枚举</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span>
</span></span></code></pre></div></blockquote>
<p>对于路径参数的数值校验可以使用<code>Path</code>类型，其具体使用与之后的<code>Query</code>基本类似，如下代码进行演示</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_items</span><span class="p">(</span><span class="n">q</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                     <span class="n">item_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;The ID of the item to get&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                         <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="c1"># 大于0，小于1000</span>
</span></span><span class="line"><span class="cl">                                        <span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;item_id&#34;</span><span class="p">:</span> <span class="n">item_id</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">q</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">results</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&#34;q&#34;</span><span class="p">:</span> <span class="n">q</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">results</span>
</span></span></code></pre></div></li>
<li>
<p>查询参数</p>
<p>当在函数的参数中声明不属于路径参数的其他参数的时候，会被解释为<strong>查询参数</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item</span><span class="p">(</span><span class="n">skip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fake_items_db</span><span class="p">[</span><span class="n">skip</span> <span class="p">:</span> <span class="n">skip</span> <span class="o">+</span> <span class="n">limit</span><span class="p">]</span>
</span></span></code></pre></div><p>在上述代码中，查询参数有<code>skip</code>与<code>limit</code>两个，在请求的时候可以通过如下URL进行请求</p>
<pre tabindex="0"><code>http://127.0.0.1:8000/items/?skip=0&amp;limit=10
</code></pre><p>对于这一类型的参数，一般会提供默认值，或者使用<code>None</code>来声明，将其变化为可选参数。若不提供任何默认值，则在请求的时候必须提供这一参数，否则会报错。</p>
<blockquote>
<p>路径参数与查询参数使用名称进行检测，可以<strong>以任特定的顺序</strong>来进行声明</p></blockquote>
<p>除了一些基础的校验外，有时候需要为查询参数加入更多的校验（例如字符串长度），可以使用<code>Query</code>来进行实现</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">Query</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_items</span><span class="p">(</span><span class="n">q</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> 
</span></span><span class="line"><span class="cl">                     <span class="n">Query</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1">#设置默认值</span>
</span></span><span class="line"><span class="cl">                           <span class="n">title</span><span class="o">=</span><span class="s2">&#34;Query string&#34;</span><span class="p">,</span> <span class="c1"># 设置参数名字</span>
</span></span><span class="line"><span class="cl">                           <span class="n">description</span><span class="o">=</span><span class="s2">&#34;Query string&#34;</span><span class="p">,</span> <span class="c1"># 设置参数描述</span>
</span></span><span class="line"><span class="cl">                           <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="c1">#设置最小长度</span>
</span></span><span class="line"><span class="cl">                           <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="c1"># 设置最大长度</span>
</span></span><span class="line"><span class="cl">                           <span class="n">regex</span><span class="o">=</span><span class="s2">&#34;^fixedquery$&#34;</span><span class="p">,</span> <span class="c1">#设置正则表达式</span>
</span></span><span class="line"><span class="cl">                           <span class="n">eprecated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># 设置为弃用参数</span>
</span></span><span class="line"><span class="cl">                           <span class="n">alias</span><span class="o">=</span><span class="s2">&#34;item-query&#34;</span><span class="p">)):</span> <span class="c1"># 设置参数别名</span>
</span></span><span class="line"><span class="cl">    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;items&#34;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&#34;item_id&#34;</span><span class="p">:</span> <span class="s2">&#34;Foo&#34;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&#34;item_id&#34;</span><span class="p">:</span> <span class="s2">&#34;Bar&#34;</span><span class="p">}]}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">q</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">results</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&#34;q&#34;</span><span class="p">:</span> <span class="n">q</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">results</span>
</span></span></code></pre></div><p>在上述的代码中，使用<code>Query</code>来对于参数进行校验以及默认值设置，当我们想要将其转变为必选参数的时候，则需要以<code>from pydantic import Required</code>中的<code>Required</code>作为默认值</p>
</li>
</ul>
<h3 id="请求体">
  请求体
  <a class="heading-link" href="#%e8%af%b7%e6%b1%82%e4%bd%93">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>当数据需要从客户端发送API的时候，通常作为请求体进行发送。<strong>请求体</strong>是客户端发送给API的数据，<strong>响应体</strong>是API发送给客户端的数据。当我们需要使用请求体的时候，需要使用到<code>Pydantic</code>的<code>BaseModel</code>。</p>
<ul>
<li>
<p>模型的创建</p>
<p>一个基本的请求体设计如下所示</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 导入基础的模型</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 声明模型以及其属性</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">price</span><span class="p">:</span> <span class="nb">float</span>
</span></span><span class="line"><span class="cl">    <span class="n">tax</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span></span></code></pre></div><p>上述模型有四个参数，可以看作一个<code>JSON</code>对象，其中<code>description</code>和<code>tax</code>是可选参数，也可以不进行提供</p>
</li>
<li>
<p>模型的使用</p>
<p>基础的使用方式就是接受一个<code>post</code>提供的json，如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Item</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">item_dict</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span> <span class="c1">#直接转化为字典进行使用</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">item</span>
</span></span></code></pre></div><p>通常的情况下，我们会接收到请求体、路径参数、查询参数三个部分，例如下面的情况</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.put</span><span class="p">(</span><span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Item</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;item_id&#34;</span><span class="p">:</span> <span class="n">item_id</span><span class="p">,</span> <span class="o">**</span><span class="n">item</span><span class="o">.</span><span class="n">dict</span><span class="p">()}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">q</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&#34;q&#34;</span><span class="p">:</span> <span class="n">q</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span></code></pre></div><blockquote>
<p><code>item_id</code>根据路径参数获得，<code>item</code>在请求体中获得、<code>q</code>在两者都没有，因此上查询参数获得</p></blockquote>
</li>
</ul>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2024 -
    
    2025
     ChengAo Shen 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
